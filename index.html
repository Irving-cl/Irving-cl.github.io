<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  

  
  <title>Cao Li&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Some study by interest, mainly on competitive programming, algorithm and developing.">
<meta name="keywords" content="Competitive programming, Algorithm, Software developing">
<meta property="og:type" content="website">
<meta property="og:title" content="Cao Li&#39;s blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Cao Li&#39;s blog">
<meta property="og:description" content="Some study by interest, mainly on competitive programming, algorithm and developing.">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Cao Li&#39;s blog">
<meta name="twitter:description" content="Some study by interest, mainly on competitive programming, algorithm and developing.">
  
    <link rel="alternate" href="/atom.xml" title="Cao Li&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Cao Li&#39;s blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-connectivity-and-tarjan-algorithm" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/27/connectivity-and-tarjan-algorithm/" class="article-date">
  <time datetime="2018-09-27T14:51:21.000Z" itemprop="datePublished">2018-09-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/competitive-programming/">competitive programming</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/27/connectivity-and-tarjan-algorithm/">Connectivity &amp; Tarjan Algorithm</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Well, I think <strong>Tarjan</strong> algorithm is quite basic in graph theory. It’s only an simple application of <strong>dfs</strong>. Inspite of this, I usually refer to the internet or past code of it when I need to use it. So I try to figure out how it works in this blog and hope that I can learn it by heart.</p>
<p>As we all know, the <strong>Tarjan</strong> algorithm enables us to find all the <strong>articulation</strong> points in $O(|V| + |E|)$ time complexity. Actually it’s famous for find strongly connected components in DAG(directional acyclic graph). But here we only focus on using it to find articulation points in undirectional graph.</p>
<p>Articulation point, also called cut vertex, is any vertex whose removal increases the number of components.</p>
<p>Then we talk about how <strong>Tarjan</strong> algorithm works. It actually runs a depth-first-search and during the process it assigns two numbers to each vertex. Let’s call them <strong>dfn</strong> and <strong>low</strong>. <strong>dfn</strong> is the order in which the vertex is visited during the whole dfs process. And <strong>low</strong> is the smallest <strong>dfn</strong> of any vertex that can be visited by current vertex in the depth-first-search tree. So when we found two vertices where $low[v] \ge dfn[u]$, that means we have to visit <code>u</code> before reaching <code>v</code> in the dfs tree. As a result, <code>u</code> is a articulation point. But be careful that there is a special case: <code>u</code> is the root vertex in the dfs tree. Then for any vertex v the above condition holds. A root would be a cut vertex when it has more than one sub trees in dfs tree. Since its sub trees are not connected apparently, cutting the root will make the sub trees seperated. So this is the main idea.</p>
<p>Now let’s see how to calculate <strong>dfn</strong> and <strong>low</strong> and implement the algorithm. <strong>dfn</strong> is quite easy to get, we just maintain a counter and increase it by one in each step of the dfs and assign it to the current vertex.<br>For <strong>low</strong>, there are three cases:</p>
<ol>
<li>$low[u] = dfn[u]$, this is the base case.</li>
<li>$low[u] = dfn[v]$, this happens when Edge(u,v) is a back edge.</li>
<li>$low[u] = low[v]$, this happens when Edge(u,v) is a forward edge.</li>
</ol>
<p>Here is the code:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">505</span>,M=<span class="number">50000</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> to,next;</span><br><span class="line">&#125; e[M];</span><br><span class="line"><span class="keyword">int</span> head[N],tot;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_edge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    e[tot].to=v;</span><br><span class="line">    e[tot].next=head[u];</span><br><span class="line">    head[u]=tot++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> counter=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> dfn[N],low[N];</span><br><span class="line"><span class="keyword">bool</span> found=<span class="literal">false</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> pa)</span> </span>&#123;</span><br><span class="line">    dfn[u]=low[u]=++counter;</span><br><span class="line">    <span class="keyword">int</span> son=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=head[u];i!=<span class="number">-1</span>;i=e[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> to=e[i].to;</span><br><span class="line">        <span class="keyword">if</span> (!dfn[to]) &#123;</span><br><span class="line">            dfs(to,u);</span><br><span class="line">            <span class="keyword">if</span> (pa!=<span class="number">-1</span>&amp;&amp;dfn[u]&lt;=low[to]) &#123;</span><br><span class="line">                found=<span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            low[u]=min(low[u],low[to]);</span><br><span class="line">            son++;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (to!=pa) &#123;</span><br><span class="line">            low[u]=min(low[u],dfn[to]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (pa==<span class="number">-1</span>&amp;&amp;son&gt;<span class="number">1</span>) &#123;</span><br><span class="line">        found=<span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>It’s just a simple dfs. When <code>found</code> variable is set to true, we get a cut vertex.</p>
<p>A graph that doesn’t contain any cut vertex is called <strong>2-connected</strong>. Let’s go a little further. A <strong>3-connected</strong> graph is such a graph that, after we remove any vertex from it, it’s still <strong>2-connected</strong>. Then how to tell if a graph is <strong>3-connected</strong>? To check if a graph is 2-connected, we can simply run the <strong>Tarjan</strong> algorithm. If we find cut vertex, then it is not 2-connected. So for checking the property of <strong>3-connected</strong>, we can enumerate the vertices and remove it, and then run the <strong>Tarjan</strong> algorithm to find a cut vertex. If after the whole process, we can still not find a cut vertex, then the graph is <strong>3-connected</strong>.<br>Here is a sample question: <a href="http://poj.org/problem?id=3713" target="_blank" rel="noopener">POJ 3713 - Transferring Sylla</a><br>And this is my code:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned ll</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> db double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">505</span>,M=<span class="number">50000</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> to,next;</span><br><span class="line">&#125; e[M];</span><br><span class="line"><span class="keyword">int</span> head[N],tot;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_edge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    e[tot].to=v;</span><br><span class="line">    e[tot].next=head[u];</span><br><span class="line">    head[u]=tot++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> counter=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> dfn[N],low[N];</span><br><span class="line"><span class="keyword">bool</span> found=<span class="literal">false</span>;</span><br><span class="line"><span class="keyword">int</span> a[M],b[M],n,m;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> pa)</span> </span>&#123;</span><br><span class="line">    dfn[u]=low[u]=++counter;</span><br><span class="line">    <span class="keyword">int</span> son=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=head[u];i!=<span class="number">-1</span>;i=e[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> to=e[i].to;</span><br><span class="line">        <span class="keyword">if</span> (!dfn[to]) &#123;</span><br><span class="line">            dfs(to,u);</span><br><span class="line">            <span class="keyword">if</span> (pa!=<span class="number">-1</span>&amp;&amp;dfn[u]&lt;=low[to]) &#123;</span><br><span class="line">                found=<span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            low[u]=min(low[u],low[to]);</span><br><span class="line">            son++;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (to!=pa) &#123;</span><br><span class="line">            low[u]=min(low[u],dfn[to]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (pa==<span class="number">-1</span>&amp;&amp;son&gt;<span class="number">1</span>) &#123;</span><br><span class="line">        found=<span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">three_conn</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++) &#123;</span><br><span class="line">        <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line">        tot=<span class="number">0</span>;</span><br><span class="line">        found=<span class="literal">false</span>;</span><br><span class="line">        counter=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[j]!=i&amp;&amp;b[j]!=i) &#123;</span><br><span class="line">                add_edge(a[j],b[j]);</span><br><span class="line">                add_edge(b[j],a[j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">memset</span>(dfn,<span class="number">0</span>,<span class="keyword">sizeof</span>(dfn));</span><br><span class="line">        <span class="built_in">memset</span>(low,<span class="number">0</span>,<span class="keyword">sizeof</span>(low));</span><br><span class="line">        <span class="keyword">if</span> (i==<span class="number">0</span>) &#123;</span><br><span class="line">            dfs(<span class="number">1</span>,<span class="number">-1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            dfs(<span class="number">0</span>,<span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (counter!=n<span class="number">-1</span>||found) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">        <span class="keyword">if</span> (n==<span class="number">0</span>&amp;&amp;m==<span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;i++) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,a+i,b+i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (three_conn()) <span class="built_in">printf</span>(<span class="string">"YES\n"</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"NO\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/09/27/connectivity-and-tarjan-algorithm/" data-id="cjmkpj1ro0005j8tsma43mx5u" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/connectivity/">connectivity</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dfs/">dfs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/graph-theory/">graph theory</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-minimum-cut-problems" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/15/minimum-cut-problems/" class="article-date">
  <time datetime="2018-07-15T03:25:19.000Z" itemprop="datePublished">2018-07-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/competitive-programming/">competitive programming</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/15/minimum-cut-problems/">Minimum Cut Problems</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>I think these problems are difficult because they are obscure. I mean, we can hardly recognize them and adopt a minimum-cut solution, at least for me. Maybe solving a great many of these problems would help. One characteristic of these problems is that we need to <strong>divide some elements into two sets(source and sink) to get some optimal result</strong>.<br>Let’s see some problems:</p>
<h3 id="POJ-3469-Dual-Core-CPU"><a href="#POJ-3469-Dual-Core-CPU" class="headerlink" title="POJ 3469 - Dual Core CPU"></a>POJ 3469 - Dual Core CPU</h3><p>Problem: <a href="http://poj.org/problem?id=3469" target="_blank" rel="noopener">POJ 3469 - Dual Core CPU</a><br>There are 2 cores A, B and N tasks to be processed. The time cost for the i-th task on A, B are $a_{i}$, $b_{i}$ respectively. And for some tasks, when processed on two different cores, will exert an extra cost. For each task, decide which core should it be processed by to make the total cost minimized.<br>In this problem, we divide the tasks into two sets(processed on A, and on B). So we try to reduce it to a minimum-cut problem. Apparently, the minimized cost corresponds to the minimum cut.<br>For each task <code>i</code>, we add an edge from <code>source</code> to <code>i</code> whose weight equals to $b_{i}$. Then if this edge is among the cut set, task <code>i</code> is processed on core B. For the same reason, we add an edge from <code>i</code> to <code>sink</code> whose weight equals to $a_{i}$. Finally, for those tasks who effect each other, say <code>i</code> and <code>j</code>, we add two edges between <code>i</code> and <code>j</code>(in two directions), whose weight equals to the extra cost. Now the minumum cut of the graph is equal to the minimized cost we want to get.<br>Pseudo code:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;a,&amp;b);</span><br><span class="line">        add_edge(<span class="number">0</span>,i,b);</span><br><span class="line">        add_edge(i,<span class="number">0</span>,<span class="number">0</span>);    <span class="comment">// reverse edge</span></span><br><span class="line">        add_edge(i,n+<span class="number">1</span>,a);</span><br><span class="line">        add_edge(n+<span class="number">1</span>,i,<span class="number">0</span>);  <span class="comment">// reverse edge</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;a,&amp;b,&amp;w);    <span class="comment">// extra cost</span></span><br><span class="line">        add_edge(a,b,w);</span><br><span class="line">        add_edge(b,a,<span class="number">0</span>);    <span class="comment">// reverse edge</span></span><br><span class="line">        add_edge(b,a,w);</span><br><span class="line">        add_edge(a,b,<span class="number">0</span>);    <span class="comment">// reverse edge</span></span><br><span class="line">    &#125;</span><br><span class="line">    ll mx_flow=max_flow();  <span class="comment">// get the answer</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Code-Jam-World-Finals-2009-Problem-D-Wi-fi-Towers"><a href="#Code-Jam-World-Finals-2009-Problem-D-Wi-fi-Towers" class="headerlink" title="Code Jam - World Finals 2009 - Problem D. Wi-fi Towers"></a>Code Jam - World Finals 2009 - Problem D. Wi-fi Towers</h3><p>Problem: <a href="https://code.google.com/codejam/contest/311101/dashboard#s=p3" target="_blank" rel="noopener">Wi-fi Towers</a><br>Given N wi-fi towers, the i-th is located at $x_{i}$, $y_{i}$, and has a range $r_{i}$. Now we want to upgrade the protocol of them. The score of upgrading the i-th tower is $s_{i}$. When the i-th tower is upgraded, all towers within its range have to be upgraded as well. Decide which towers to be upgraded to make the total score maximized.<br>Wow, world final problem!<br>It’s quite difficult to associate this with minimum-cut. The two sets are <strong>towers to be upgraded</strong> and <strong>towers not to be upgraded</strong>.<br>We want maximum score, so we calculate the minimum <strong>lost</strong>. If $s_{i}$ is negative, the absolute value of it is a lost. We add an edge from <code>source</code> to <code>i</code> whose weight is $|s_{i}|$. If $s_{i}$ is positive, we can imagine that tower i has already been upgraded at first, and “upgrading” it to the origin exerts a lost. We add an edge from <code>i</code> to <code>sink</code> whose weight is $|s_{i}|$. We need to add the positive values to the answer, of course.<br>Then consider the constraints. If <code>j</code> has to be upgraded if <code>i</code> is upgraded, we add an edge from j to i, whose weight is $\infty$. As a result, if we upgrade <code>i</code> without upgrading <code>j</code>, the cut value will be infinity.<br>Now we reduce the minimized lost from the answer, and we get the maximum score.<br>Pseudo code:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> src=<span class="number">0</span>,sink=n+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (s[i]&lt;<span class="number">0</span>) &#123;</span><br><span class="line">            add_edge(<span class="number">0</span>,i,-s[i]);</span><br><span class="line">            add_edge(i,<span class="number">0</span>,<span class="number">0</span>);    <span class="comment">// reverse edge</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            add_edge(i,n+<span class="number">1</span>,s[i]);</span><br><span class="line">            add_edge(n+<span class="number">1</span>,i,<span class="number">0</span>);  <span class="comment">// reverse edge</span></span><br><span class="line">            ans+=s[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i==j) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (sqr(x[i]-x[j])+sqr(y[i]-y[j])&lt;=sqr(r[i])) &#123;    <span class="comment">// within the range</span></span><br><span class="line">                add_edge(j,i,INF);</span><br><span class="line">                add_edge(i,j,<span class="number">0</span>);    <span class="comment">// reverse edge</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mx_flow=max_flow();</span><br><span class="line">    ans-=mx_flow;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Hope I will recognize the minimum-cut problem when I meet one next time…</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/15/minimum-cut-problems/" data-id="cjmkpj1s7000mj8tsa422tdus" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/max-flow/">max-flow</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/minimum-cut/">minimum-cut</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-cf-992E" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/08/cf-992E/" class="article-date">
  <time datetime="2018-07-08T01:12:45.000Z" itemprop="datePublished">2018-07-08</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/competitive-programming/">competitive programming</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/08/cf-992E/">Codeforces 992E - Nastya and King-Shamans</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Problem: <a href="http://codeforces.com/problemset/problem/992/E" target="_blank" rel="noopener">Codeforces 992E Nastya and King-Shamans</a><br>Given n intergers $ a_{1},a_{2},…a_{n} $ and q operations $(p_{i}, x_{i})$, $1 \le n,q \le 2 \cdot 10^{5} $. In each operation, change $a_{p_{i}}$ to $x_{i}$, and after that give any index k such that $ a_{k} = \sum_{i=1}^{k-1} a_{i} $ if there exists one.</p>
<h3 id="Segment-tree-solution"><a href="#Segment-tree-solution" class="headerlink" title="Segment tree solution"></a>Segment tree solution</h3><p>For each query, we search the answer from left to right. We maintain a <code>cur_sum</code>, which is the sum of $a_{i}$ we have passed, meaning that we haven’t found a answer till now. So we go on to find it in the right part. We need to find an <strong>leftmost</strong> element that is at least <code>cur_sum</code>. If we find one, then we are done. If we don’t find it, we add that element to <code>cur_sum</code>. As it is the leftmost one, we wouldn’t omit any answer. And since the <code>cur_sum</code> will be at least <strong>twice</strong> as big as it was, the count repeated search for one operation will be at most <strong>log(MAX)</strong>.<br>We can use segment tree to maintain the <strong>sum</strong> and <strong>max value</strong> to do the queries.<br>My code:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned ll</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> db double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">200010</span>;</span><br><span class="line">ll s[N*<span class="number">4</span>],mx[N*<span class="number">4</span>],a[N];</span><br><span class="line"><span class="keyword">int</span> n,q,p,x;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l==r) &#123;</span><br><span class="line">        mx[x]=s[x]=a[l];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    build(<span class="number">2</span>*x,l,m);</span><br><span class="line">    build(<span class="number">2</span>*x+<span class="number">1</span>,m+<span class="number">1</span>,r);</span><br><span class="line">    mx[x]=max(mx[<span class="number">2</span>*x],mx[<span class="number">2</span>*x+<span class="number">1</span>]);</span><br><span class="line">    s[x]=s[<span class="number">2</span>*x]+s[<span class="number">2</span>*x+<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> pos,ll val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l==r) &#123;</span><br><span class="line">        mx[x]=s[x]=val;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (pos&lt;=m) update(<span class="number">2</span>*x,l,m,pos,val);</span><br><span class="line">    <span class="keyword">else</span> update(<span class="number">2</span>*x+<span class="number">1</span>,m+<span class="number">1</span>,r,pos,val);</span><br><span class="line">    mx[x]=max(mx[<span class="number">2</span>*x],mx[<span class="number">2</span>*x+<span class="number">1</span>]);</span><br><span class="line">    s[x]=s[<span class="number">2</span>*x]+s[<span class="number">2</span>*x+<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">get_sum</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> lq,<span class="keyword">int</span> rq)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (lq&lt;=l&amp;&amp;r&lt;=rq) <span class="keyword">return</span> s[x];</span><br><span class="line">    <span class="keyword">if</span> (lq&gt;r||rq&lt;l) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> get_sum(<span class="number">2</span>*x,l,m,lq,rq)+get_sum(<span class="number">2</span>*x+<span class="number">1</span>,m+<span class="number">1</span>,r,lq,rq);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">down</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> l,<span class="keyword">int</span> r,ll val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l==r) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mx[x]&gt;=val) <span class="keyword">return</span> l;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> n+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (mx[<span class="number">2</span>*x]&gt;=val) <span class="keyword">return</span> down(<span class="number">2</span>*x,l,m,val);</span><br><span class="line">    <span class="keyword">return</span> down(<span class="number">2</span>*x+<span class="number">1</span>,m+<span class="number">1</span>,r,val);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_left</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> lq,<span class="keyword">int</span> rq,ll val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l&gt;rq||lq&gt;r) <span class="keyword">return</span> n+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (lq&lt;=l&amp;&amp;r&lt;=rq) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mx[x]&lt;val) <span class="keyword">return</span> n+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> down(x,l,r,val);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> res=get_left(<span class="number">2</span>*x,l,m,lq,rq,val);</span><br><span class="line">    <span class="keyword">if</span> (res!=n+<span class="number">1</span>) <span class="keyword">return</span> res;</span><br><span class="line">    <span class="keyword">return</span> get_left(<span class="number">2</span>*x+<span class="number">1</span>,m+<span class="number">1</span>,r,lq,rq,val);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> idx=<span class="number">0</span>;</span><br><span class="line">    ll sum=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (idx&lt;n+<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> new_idx=get_left(<span class="number">1</span>,<span class="number">1</span>,n,idx+<span class="number">1</span>,n,sum);</span><br><span class="line">        <span class="keyword">if</span> (new_idx==n+<span class="number">1</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        ll pre_sum=get_sum(<span class="number">1</span>,<span class="number">1</span>,n,<span class="number">1</span>,new_idx<span class="number">-1</span>);</span><br><span class="line">        ll ele=get_sum(<span class="number">1</span>,<span class="number">1</span>,n,new_idx,new_idx);</span><br><span class="line">        <span class="keyword">if</span> (pre_sum==ele) <span class="keyword">return</span> new_idx;</span><br><span class="line">        idx=new_idx;</span><br><span class="line">        sum=pre_sum+ele;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;q);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,a+i);</span><br><span class="line">    build(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=q;i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;p,&amp;x);</span><br><span class="line">        update(<span class="number">1</span>,<span class="number">1</span>,n,p,x);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,solve());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Square-decomposition"><a href="#Square-decomposition" class="headerlink" title="Square decomposition"></a>Square decomposition</h3><p>Let $p_{i}$ be the prefix sum of a, and $f_{i} = p_{i} - 2 \cdot a_{i}$. Then we only need to find an i such that $f_{i} = 0$. And each time we change $a_{i}$ to <code>val</code>, let $\delta = val - a_{i}$, $f_{i}$ should decrease by $\delta$ whereas $f_{k}(k&gt;i)$ should increase by $\delta$.<br>Next we divide the sequence of groups of size M. For each change, we may change at most <strong>N\M</strong> groups as a whole and deal with all the elements in one group. And for query, we keep all elements in a group in order so that we can use binary search. To do with the single group which is not entirely coverd by the range, we can do something like merging sorted vectors.<br>Though the solution is still too slow to pass the tests, I think square decomposition is powerful in data structrue problems.<br>My code:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned ll</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> db double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">200010</span>;</span><br><span class="line"><span class="keyword">int</span> M=<span class="number">500</span>;</span><br><span class="line"><span class="keyword">int</span> n,p,q,x,a[N],s[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    ll val;</span><br><span class="line">    <span class="keyword">int</span> idx;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> node&amp; rhs) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> val&lt;rhs.val;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>==(<span class="keyword">const</span> node&amp; rhs) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> val==rhs.val;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;node&gt; aim[<span class="number">1000</span>];</span><br><span class="line">ll acc[<span class="number">1000</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify_group</span><span class="params">(<span class="keyword">int</span> idx,ll delta)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> gid=idx/M;</span><br><span class="line">    <span class="built_in">vector</span>&lt;node&gt; v1,v2;</span><br><span class="line">    ll pivot=<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">bool</span> added=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;aim[gid].size();i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (aim[gid][i].idx==idx) &#123;</span><br><span class="line">            pivot=aim[gid][i].val-delta;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;aim[gid].size();i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (aim[gid][i].idx&lt;idx) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!added&amp;&amp;pivot&lt;=aim[gid][i].val) &#123;</span><br><span class="line">                v1.pb(&#123;pivot,idx&#125;);</span><br><span class="line">                added=<span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            v1.pb(aim[gid][i]);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (aim[gid][i].idx&gt;idx) &#123;</span><br><span class="line">            v2.pb(aim[gid][i]);</span><br><span class="line">            v2.back().val+=delta;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!added) &#123; v1.pb(&#123;pivot,idx&#125;); &#125;</span><br><span class="line">    aim[gid].clear();</span><br><span class="line">    merge(v1.begin(),v1.end(),v2.begin(),v2.end(),back_inserter(aim[gid]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;q);</span><br><span class="line">    M=<span class="built_in">sqrt</span>(n)+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,a+i);</span><br><span class="line">        s[i]=a[i];</span><br><span class="line">        <span class="keyword">if</span> (i&gt;<span class="number">0</span>) s[i]+=s[i<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++) &#123;</span><br><span class="line">        aim[i/M].pb(&#123;s[i]<span class="number">-2</span>*a[i],i&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> g=n/M+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;g;i++) sort(aim[i].begin(),aim[i].end());</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;q;i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;p,&amp;x);</span><br><span class="line">        p--;</span><br><span class="line">        <span class="keyword">int</span> id=p/M+<span class="number">1</span>;</span><br><span class="line">        ll delta=x-a[p];</span><br><span class="line">        a[p]=x;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=id;j&lt;g;j++) acc[j]+=delta;</span><br><span class="line">        modify_group(p,delta);</span><br><span class="line">        <span class="keyword">bool</span> found=<span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;g;j++) &#123;</span><br><span class="line">            node nd=&#123;-acc[j],<span class="number">-1</span>&#125;;</span><br><span class="line">            <span class="keyword">auto</span> iter=lower_bound(aim[j].begin(),aim[j].end(),nd);</span><br><span class="line">            <span class="keyword">if</span> (iter!=aim[j].end()&amp;&amp;(*iter).val==-acc[j]) &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,(*iter).idx+<span class="number">1</span>);</span><br><span class="line">                found=<span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!found) <span class="built_in">printf</span>(<span class="string">"-1\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/08/cf-992E/" data-id="cjmkpj1rt0009j8tsf58vqhtq" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/data-structure/">data structure</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/segment-tree/">segment tree</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/square-decomposition/">square decomposition</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-cf-995C" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/07/cf-995C/" class="article-date">
  <time datetime="2018-07-07T13:44:57.000Z" itemprop="datePublished">2018-07-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/competitive-programming/">competitive programming</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/07/cf-995C/">Codeforces 995C Leaving the Bar</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Problem: <a href="http://codeforces.com/contest/995/problem/C" target="_blank" rel="noopener">Codeforces 995C Leaving the Bar</a><br>Given n two-dimensional vectors $\vec v_{i}$ and n intergers $ c_{1},c_{2},…c_{n} $. It’s guaranteed that $ |v| \le 1e6 $ and $ c_{i} = 1 or -1 $. Let $\vec p = \sum_{i=1}^{n} c_{i}\vec v_{i}$. Determine the value of $c_{i}$ to satisfy $|p| \le 1.5 \cdot 1e6$.</p>
<p>As n is at most $10^{5}$, it is impossible to enumerate all the cases.<br>The key to solve this problem is such a conclusion:<br><strong>Given 3 vectors $\vec v$, $|v| \le R$, we can always get some $\vec v_{i} + \vec v_{j}$ or $\vec v_{i} - \vec v_{j}$ that has length at least R.</strong><br>With the opposite vectors of the 3 vectors, there are 6 vectors altogether now. So if we divide the plane into 6 60-degree sectors, there is at least one sector that contains two vectors(they are not the opposite for sure). Pretty good.</p>
<p>So we can merge vectors until there are only 2 vectors.<br>We always pick 3 vectors and merge 2 of them if the length of the result vector is less equal than 1e6.<br>And we can ensure that length of the sum or difference of the last 2 vectors is less equal than $\sqrt{2} \cdot 1e6 \le 1.5 \cdot 1e6$.</p>
<p>My Code:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned ll</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> db double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">100010</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> R=<span class="number">1000000</span>;</span><br><span class="line"><span class="keyword">const</span> db eps=<span class="number">1e-8</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">P</span> &#123;</span></span><br><span class="line">    db x,y;</span><br><span class="line">    P()&#123;&#125;</span><br><span class="line">    P(db xx,db yy):x(xx),y(yy)&#123;&#125;</span><br><span class="line">    P <span class="keyword">operator</span>+(P rhs) &#123;</span><br><span class="line">        <span class="keyword">return</span> P(x+rhs.x,y+rhs.y);</span><br><span class="line">    &#125;</span><br><span class="line">    P <span class="keyword">operator</span>-(P rhs) &#123;</span><br><span class="line">        <span class="keyword">return</span> P(x-rhs.x,y-rhs.y);</span><br><span class="line">    &#125;</span><br><span class="line">    P <span class="keyword">operator</span>*(db k) &#123;</span><br><span class="line">        <span class="keyword">return</span> P(k*x,k*y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">db <span class="title">dot</span><span class="params">(P rhs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x*rhs.x+y*rhs.y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">db <span class="title">det</span><span class="params">(P rhs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x*rhs.y-y*rhs.x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> ls,rs,type;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,tot=<span class="number">0</span>;</span><br><span class="line">P vec[<span class="number">2</span>*N];</span><br><span class="line">node nd[<span class="number">2</span>*N];</span><br><span class="line"><span class="keyword">int</span> ans[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> id,<span class="keyword">int</span> type)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nd[id].ls==<span class="number">-1</span>) &#123;</span><br><span class="line">        ans[id]=type;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(nd[id].ls,type);</span><br><span class="line">    dfs(nd[id].rs,type*nd[id].type);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lf%lf"</span>,&amp;vec[tot].x,&amp;vec[tot].y);</span><br><span class="line">        nd[tot++]=&#123;<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">1</span>&#125;;</span><br><span class="line">        q.push(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (q.size()&gt;<span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> a[<span class="number">3</span>]=&#123;<span class="number">-1</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++) &#123;</span><br><span class="line">            a[i]=q.front();</span><br><span class="line">            q.pop();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> x=<span class="number">-1</span>,y=<span class="number">-1</span>,type=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>&amp;&amp;x==<span class="number">-1</span>;i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;<span class="number">3</span>&amp;&amp;x==<span class="number">-1</span>;j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">sqrt</span>((vec[a[i]]+vec[a[j]]).dot(vec[a[i]]+vec[a[j]]))&lt;R+eps) &#123;</span><br><span class="line">                    x=a[i],y=a[j];</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">sqrt</span>((vec[a[i]]-vec[a[j]]).dot(vec[a[i]]-vec[a[j]]))&lt;R+eps) &#123;</span><br><span class="line">                    x=a[i],y=a[j],type=<span class="number">-1</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[i]!=x&amp;&amp;a[i]!=y) q.push(a[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        nd[tot]=&#123;x,y,type&#125;;</span><br><span class="line">        vec[tot]=vec[x]+(vec[y]*type);</span><br><span class="line">        q.push(tot++);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (q.size()&lt;<span class="number">2</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"1\n"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> x=q.front();q.pop();</span><br><span class="line">    <span class="keyword">int</span> y=q.front();q.pop();</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">sqrt</span>((vec[x]+vec[y]).dot(vec[x]+vec[y]))&lt;<span class="built_in">sqrt</span>(<span class="number">2</span>)*R+eps) &#123;</span><br><span class="line">        nd[tot++]=&#123;x,y,<span class="number">1</span>&#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        nd[tot++]=&#123;x,y,<span class="number">-1</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(tot<span class="number">-1</span>,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>,ans[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/07/cf-995C/" data-id="cjmkpj1rv000aj8tsehw68qam" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/brute-force/">brute force</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/codeforces/">codeforces</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/geometry/">geometry</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-subsets-property-merge" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/07/subsets-property-merge/" class="article-date">
  <time datetime="2018-07-07T02:47:37.000Z" itemprop="datePublished">2018-07-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/competitive-programming/">competitive programming</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/07/subsets-property-merge/">Subsets Property Merge</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Given such a problem:<br>There is a sequence of length N: $ A_{0} $, $ A_{1} $,…, $ A_{N} $. For every integer K satisfying $ 1 \le K \le N $, find the maximum value of $A_{i}+A_{j}$ where $i\subseteq K$ and $j \subseteq K$. Here, <strong>$a \subseteq b$</strong> means that, in binary representation, the set of positions of a is a subset of that of b.<br>This problem is actually a subproblem of <a href="https://beta.atcoder.jp/contests/arc100/tasks/arc100_c" target="_blank" rel="noopener">ARC 100 E</a>. The solution to such problem is very similar to dynamic programming and I think it could be used in many cases.<br>Code:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned ll</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> db double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1</span>&lt;&lt;<span class="number">18</span>;</span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line">PII mx[N];</span><br><span class="line"><span class="keyword">int</span> n;    <span class="comment">// n is the count of digits</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a[i]&lt;a[j];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; cur;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;(<span class="number">1</span>&lt;&lt;n);i++) &#123;</span><br><span class="line">        cur.clear();</span><br><span class="line">        cur.pb(i);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n;j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> ((i&gt;&gt;j)&amp;<span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">int</span> x=i^(<span class="number">1</span>&lt;&lt;j);</span><br><span class="line">                cur.pb(mx[x].first);</span><br><span class="line">                <span class="keyword">if</span> (mx[i].second!=<span class="number">-1</span>) cur.pb(mx[x].second);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        sort(cur.begin(),cur.end());</span><br><span class="line">        cur.resize(unique(cur.begin(),cur.end())-cur.begin());</span><br><span class="line">        <span class="keyword">if</span> (cur.size()==<span class="number">1</span>) &#123;</span><br><span class="line">            mx[i]=mp(cur[<span class="number">0</span>],<span class="number">-1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            mx[i]=mp(cur[<span class="number">0</span>],cur[<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>The two elements of <code>mx[k]</code> are the two largest elements satisfying $i \subseteq k$ and $j \subseteq k$. So we can get the maximum value of $A_{i} + A_{j}$.<br>Here we compute the result of k from the result of its <em>subsets</em>(has only one bit different).</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/07/subsets-property-merge/" data-id="cjmkpj1sb000tj8ts6no8qgab" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dynamic-programming/">dynamic programming</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-geometry-basics" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/02/geometry-basics/" class="article-date">
  <time datetime="2018-07-02T15:00:08.000Z" itemprop="datePublished">2018-07-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/competitive-programming/">competitive programming</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/02/geometry-basics/">Geometry Basics</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Geometry is a important part in competitive programming. However, it doesn’t appear much in small races. That’s why I’m quite unfamiliar with it. But I’m convinced that I will have to handle these problems sooner or later.</p>
<p>This blog is just a very start of geometry. I collect some very basic things in geometry and we only talk about two-dimensional. All the vectors mentioned below are two-dimensional.</p>
<p>I would introduce:</p>
<ol start="0">
<li>Common data structure for geometry problems</li>
<li>Dot product</li>
<li>Cross product</li>
<li>Are the two vectors parallel</li>
<li>Is the point on the line or the segment</li>
<li>Get the cross point of two lines</li>
<li>Do the two segments touch each other</li>
</ol>
<h3 id="Common-data-structure"><a href="#Common-data-structure" class="headerlink" title="Common data structure"></a>Common data structure</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">P</span> &#123;</span></span><br><span class="line">    db x,y;</span><br><span class="line">    P()&#123;&#125;</span><br><span class="line">    P(db xx,db yy):x(xx),y(yy)&#123;&#125;</span><br><span class="line">    P <span class="keyword">operator</span>+(P rhs) &#123;</span><br><span class="line">        <span class="keyword">return</span> P(x+rhs.x,y+rhs.y);</span><br><span class="line">    &#125;</span><br><span class="line">    P <span class="keyword">operator</span>-(P rhs) &#123;</span><br><span class="line">        <span class="keyword">return</span> P(x-rhs.x,y-rhs.y);</span><br><span class="line">    &#125;</span><br><span class="line">    P <span class="keyword">operator</span>*(db k) &#123;</span><br><span class="line">        <span class="keyword">return</span> P(k*x,k*y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">db <span class="title">dot</span><span class="params">(P rhs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x*rhs.x+y*rhs.y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">db <span class="title">det</span><span class="params">(P rhs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x*rhs.y-y*rhs.x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>This is a really simple struct, but it is quite powerful. It enables us to implement geometry algorithm elegantly. One of the good parts of it is that it can be taken as both a <code>Point</code> as well as a <code>Two-dimensional vector</code>.</p>
<h3 id="Dot-product"><a href="#Dot-product" class="headerlink" title="Dot product"></a>Dot product</h3><p>$$ \overrightarrow{AB} \cdot \overrightarrow{AC} = a $$<br>The geometric meaning of dot product is the length(maybe negative) of the projection of one vector onto the other. The result of dot product is a <strong>value</strong>.</p>
<h3 id="Cross-product"><a href="#Cross-product" class="headerlink" title="Cross product"></a>Cross product</h3><p>$$ \overrightarrow{AB} \times \overrightarrow{AC} = \overrightarrow{AD} $$<br>The result of cross product is actually a <strong>vector</strong> which is perpendicular to the plane which is deterimined by the two vectors. But in two dimension, we can take the result as a <strong>value</strong> which is equal to the area of the parallelogram determined by the two vectors.</p>
<h3 id="Are-the-two-vectors-parallel"><a href="#Are-the-two-vectors-parallel" class="headerlink" title="Are the two vectors parallel"></a>Are the two vectors parallel</h3><p>This is quite simple. When two vectors are parallel, the area of the parallelogram formed by them is <strong>0</strong>. So we can use cross product to get the area of the parallelogram and tell if the two vectors are parallel.</p>
<h3 id="Is-the-point-on-the-line-or-the-segment"><a href="#Is-the-point-on-the-line-or-the-segment" class="headerlink" title="Is the point on the line or the segment"></a>Is the point on the line or the segment</h3><p>Let’s start with line.  Call the point to be judged <code>A</code>, and find any two points <code>B</code>,<code>C</code> on the line.<br>Obviously, if <code>A</code> is on the line, then we have:<br>$$ \overrightarrow{AB} \times \overrightarrow{AC} = 0 $$<br>Now let’s go with segment. We call the two endpoints of the segment <code>B</code>, <code>C</code> now.<br>If <code>A</code> is on the segment, <code>A</code> has to be on the line first. Then <code>B</code> and <code>C</code> should be on different sides of <code>A</code>. We can check this simply by:<br>$$ \overrightarrow{AB} \cdot \overrightarrow{AC} &lt;= 0 $$</p>
<h3 id="Get-the-cross-point-of-two-lines"><a href="#Get-the-cross-point-of-two-lines" class="headerlink" title="Get the cross point of two lines"></a>Get the cross point of two lines</h3><p>We need pay attention to whether the two lines are <strong>exactly the same line</strong> and whether they are <strong>parallel</strong> at first.<br>Say, <code>p1</code> and <code>p2</code> are two points one line 1.<br>Then we can represent any point on line 1 as: $ p_{1} + t \cdot (p_{2} - p_{1}) $.<br>And what we need to do is to calculate <code>t</code> to make the point on line 2.<br>We can calculate <code>t</code> as :<br>$$<br>t = \frac<br>{(q_{2} - q_{1}) \times (q_{1} - p_{1})}<br>{(q_{2} - q_{1}) \times (p_{2} - p_{1})}<br>$$<br>So the cross point is:<br>$$<br>p_{1} +<br>\frac<br>{(q_{2} - q_{1}) \times (q_{1} - p_{1})}<br>{(q_{2} - q_{1}) \times (p_{2} - p_{1})}<br>\cdot<br>(p_{2} - p_{1})<br>$$<br>I cannot explain clearly why it works. We can simply think the proportion of area of two parallelograms.</p>
<h3 id="Do-the-two-segments-touch-each-other"><a href="#Do-the-two-segments-touch-each-other" class="headerlink" title="Do the two segments touch each other"></a>Do the two segments touch each other</h3><p>Since we have <strong>4</strong> and <strong>5</strong>, we can do tell this easily. First, we get the cross point of the two lines where the two segments lie. Next, we judge if the cross point is on both segments. Really simple, right?</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/02/geometry-basics/" data-id="cjmkpj1s1000gj8tsgtji3z29" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/geometry/">geometry</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-max-flow-algorithm" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/30/max-flow-algorithm/" class="article-date">
  <time datetime="2018-06-30T01:16:14.000Z" itemprop="datePublished">2018-06-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/competitive-programming/">competitive programming</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/30/max-flow-algorithm/">Max Flow Algorithm</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Maximum</strong> flow is a important part of graph theory in competitive programming. There have been already thousands of articles and blogs teaching people the principle and the implementation of max flow. So I’m not going to elaborate these things again. This blog is just written to help me implement the max flow algorithm faster in a competition with less mistakes.</p>
<h2 id="Ford-Fulkson"><a href="#Ford-Fulkson" class="headerlink" title="Ford-Fulkson"></a>Ford-Fulkson</h2><p>The main idea of max flow algorithm is to find <strong>augmented path</strong> until there is no one. When we find an augmented path, we need to change the residual graph. We should reduce the capcity of each edge on the path and increase it on each reverse edge on it by the flow we found. So in the implementation we don’t need to store the current flow of each edge, we just need to store the capcity of them.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">20005</span>,M=<span class="number">2000005</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> to,next,cap;</span><br><span class="line">&#125; e[N];</span><br><span class="line"><span class="keyword">int</span> head[N],tot;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_edge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> cap)</span> </span>&#123;</span><br><span class="line">    e[tot].to=v;</span><br><span class="line">    e[tot].cap=cap;</span><br><span class="line">    e[tot].next=head[u];</span><br><span class="line">    head[u]=tot++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> vis[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> sink,<span class="keyword">int</span> f)</span> </span>&#123;</span><br><span class="line">    vis[u]=<span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (u==sink) <span class="keyword">return</span> f;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=head[u];i!=<span class="number">-1</span>;i=e[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> to=e[i].to;</span><br><span class="line">        <span class="keyword">if</span> (!vis[to]&amp;&amp;e[i].cap&gt;<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> ff=dfs(to,min(f,e[i].cap));</span><br><span class="line">            <span class="keyword">if</span> (ff&gt;<span class="number">0</span>) &#123;</span><br><span class="line">                e[i].cap-=cap;</span><br><span class="line">                e[i^<span class="number">1</span>].cap+=cap;</span><br><span class="line">                <span class="keyword">return</span> ff;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line">    <span class="comment">// Build graph here</span></span><br><span class="line">    <span class="keyword">int</span> max_flow=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</span><br><span class="line">        <span class="keyword">int</span> ff=dfs(src,sink,INF);</span><br><span class="line">        <span class="keyword">if</span> (ff&gt;<span class="number">0</span>) max_flow+=ff;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"max_flow:%d\n"</span>,max_flow);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>Ford-Fulkson</strong> is fast enough in most cases. But sometime it cannot meet our requirements. That’s why we need <strong>Dinic</strong>.</p>
<h2 id="Dinic"><a href="#Dinic" class="headerlink" title="Dinic"></a>Dinic</h2><p>Two optimizations are used in <strong>Dinic</strong> which make it faster. One is<code>level</code> array and the other is <code>arc optimization</code>. I’m not going to elaborate how they work here. Different from <strong>Ford-Fulkson</strong>, it runs a <code>bfs</code> to build the <code>level graph</code> and then run <code>dfs</code> a couple of times(without initializing).<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">20005</span>,M=<span class="number">2000005</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> to,next,cap;</span><br><span class="line">&#125; e[N];</span><br><span class="line"><span class="keyword">int</span> head[N],tot;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_edge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> cap)</span> </span>&#123;</span><br><span class="line">    e[tot].to=v;</span><br><span class="line">    e[tot].cap=cap;</span><br><span class="line">    e[tot].next=head[u];</span><br><span class="line">    head[u]=tot++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> level[N],iter[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> src)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">    <span class="built_in">memset</span>(level,<span class="number">-1</span>,<span class="keyword">sizeof</span>(level));</span><br><span class="line">    level[src]=<span class="number">0</span>;</span><br><span class="line">    q.push(src);</span><br><span class="line">    <span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">        <span class="keyword">int</span> cur=q.front();</span><br><span class="line">        q.pop();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=head[cur];i!=<span class="number">-1</span>;i=e[i].next) &#123;</span><br><span class="line">            <span class="keyword">int</span> to=e[i].to;</span><br><span class="line">            <span class="keyword">if</span> (e[i].cap&gt;<span class="number">0</span>&amp;&amp;level[to]==<span class="number">-1</span>) &#123;</span><br><span class="line">                level[to]=level[cur]+<span class="number">1</span>;</span><br><span class="line">                q.push(to);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> sink,<span class="keyword">int</span> f)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (u==sink) <span class="keyword">return</span> f;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span>&amp; i=iter[u];i!=<span class="number">-1</span>;i=e[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> to=e[i].to;</span><br><span class="line">        <span class="keyword">if</span> (e[i].cap&gt;<span class="number">0</span>&amp;&amp;level[u]&lt;level[to]) &#123;</span><br><span class="line">            <span class="keyword">int</span> ff=dfs(to,sink,min(f,e[i].cap));</span><br><span class="line">            <span class="keyword">if</span> (ff&gt;<span class="number">0</span>) &#123;</span><br><span class="line">                e[i].cap-=ff;</span><br><span class="line">                e[i^<span class="number">1</span>].cap+=ff;</span><br><span class="line">                <span class="keyword">return</span> ff;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line">    <span class="comment">// Build graph here</span></span><br><span class="line">    <span class="keyword">int</span> mx_flow=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        bfs(src);</span><br><span class="line">        <span class="keyword">if</span> (level[sink]==<span class="number">-1</span>) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) iter[i]=head[i];</span><br><span class="line">        <span class="keyword">int</span> ff;</span><br><span class="line">        <span class="keyword">while</span> ((ff=dfs(src,sink,INF)&gt;<span class="number">0</span>)) &#123;</span><br><span class="line">            mx_flow+=ff;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,mx_flow);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/06/30/max-flow-algorithm/" data-id="cjmkpj1s5000jj8tsqfh8nq1w" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/max-flow/">max-flow</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-cf-984E" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/10/cf-984E/" class="article-date">
  <time datetime="2018-06-10T14:24:38.000Z" itemprop="datePublished">2018-06-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/competitive-programming/">competitive programming</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/10/cf-984E/">Codeforces 984E Elevator</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>The problem: <a href="http://codeforces.com/problemset/problem/984/E" target="_blank" rel="noopener">Codeforces 984E Elevator</a><br>I failed to solve the problem by myself although I believed it should be solved by dp immediately after I read the problem. The difficult and interesting part of this problem is how to arrange the <strong>state</strong> of the whole process so that the total number of <strong>state</strong> is as small as possible.<br>Let’s think about it. For a state transition, we need to know:</p>
<ol>
<li>How many people have got in the elevator(may have got out).</li>
<li>Current floor.</li>
<li>Which floors do people currently in the elevator want to go.</li>
</ol>
<p>The only problem is third one. There are at most 4 people in the elevator and each person may go to each of the 9 floors. So there would be<br>$$ 10^4=10000 $$<br>states in total in the 3rd dimension of dp.<br>However, it is a little bit more than we can afford. Actually some of the states in the above are repeated. Say, <code>person 1 goes to floor 3 and person 2 goes to floor 4</code> is the same as <code>person 1 goes to floor 4 and person 2 goes to 3</code>. So we only care about how many people go to each floor, with no need to know who. Hence the total number of state is:<br>$$ \binom{9}{0} + \binom{9}{1} + \binom{9}{2} + \binom{9}{3} + \binom{9}{4} = 256 $$</p>
<p>This enable us to get accepted.<br>And some technique should be adopted to represent the state. Instead of using integers, we use a 4-char-long string to represent a state. With the help of map, we can implement it nicely:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int_ int64_t</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned ll</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> db double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000003</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">2010</span>;</span><br><span class="line"><span class="keyword">int</span> n,a[N],b[N];</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="built_in">string</span>,<span class="keyword">int</span>&gt; dp[N][<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> idx,<span class="keyword">int</span> cur,<span class="keyword">const</span> <span class="built_in">string</span>&amp; s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (idx&gt;n&amp;&amp;s==<span class="string">"0000"</span>) &#123; <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="keyword">int</span>&amp; res=dp[idx][cur][s];</span><br><span class="line">    <span class="keyword">if</span> (res) <span class="keyword">return</span> res;</span><br><span class="line">    res=INF;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">char</span> c=<span class="string">'1'</span>;c&lt;=<span class="string">'9'</span>;c++) &#123;</span><br><span class="line">        <span class="built_in">string</span> t=s;</span><br><span class="line">        <span class="keyword">int</span> x=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (t[i]==c) t[i]=<span class="string">'0'</span>,x++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> now=idx;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (t[i]==<span class="string">'0'</span>&amp;&amp;now&lt;=n&amp;&amp;a[now]+<span class="string">'0'</span>==c) &#123;</span><br><span class="line">                t[i]=b[now++]+<span class="string">'0'</span>;</span><br><span class="line">                x++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        sort(t.begin(),t.end());</span><br><span class="line">        <span class="keyword">if</span> (idx==now&amp;&amp;t==s) <span class="keyword">continue</span>;</span><br><span class="line">        res=min(res,<span class="built_in">abs</span>(cur-(c-<span class="string">'0'</span>))+x+dfs(now,c-<span class="string">'0'</span>,t));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,a+i,b+i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,dfs(<span class="number">1</span>,<span class="number">1</span>,<span class="string">"0000"</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/06/10/cf-984E/" data-id="cjmkpj1rq0006j8tsyvsupzns" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/codeforces/">codeforces</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dynamic-programming/">dynamic programming</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/state-compression/">state compression</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-cf-894B" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/25/cf-894B/" class="article-date">
  <time datetime="2017-11-25T08:49:59.000Z" itemprop="datePublished">2017-11-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/competitive-programming/">competitive programming</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/25/cf-894B/">Codeforces 894B Ralph And His Magic Field</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Well, I didn’t solve it myself though it’s only B problem in Div2… Fine, this sometimes happens, never mind. Just practice more.  </p>
<p>The problem is, how many different ways can we put integers in a <em>n \</em> m* block so that the products of each row and each column is 1 or -1. </p>
<p>Let’s see how to solve it. We can easily figure out that only 1 or -1 can be put into the block. Further, another important conclusion is that <strong>when k is -1, the answer is 0 if n and m have different parity</strong>. Why is that? This is not obvious for me. If we have <code>n</code> be odd and <code>m</code> be even, then we have an even number of -1 in total since we have an even number of columns. However, we have an odd number of rows, and in each row there exists an odd number of -1. So the total number of -1 cannot be even. That’s impossible.  For the rest cases, we consider the (n-1)*(m-1) subblock. We can fill either 1 or -1 into any cell. And then the rest cells are determined.<br>The answer is:<br>$$<br>2^{(n-1)+(m-1)}<br>$$</p>
<p>With quick power, we can solve it easily.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned ll</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> db double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"></span><br><span class="line">ll n,m,k;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">qp</span><span class="params">(ll temp,ll x)</span> </span>&#123;</span><br><span class="line">    ll ret=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (x&gt;<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (x&amp;<span class="number">1</span>) ret=(ret*temp)%MOD;</span><br><span class="line">        temp=(temp*temp)%MOD;</span><br><span class="line">        x&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld"</span>,&amp;n,&amp;m,&amp;k);</span><br><span class="line">    <span class="keyword">if</span> (k==<span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((n%<span class="number">2</span>)+(m%<span class="number">2</span>)==<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"0\n"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ll ans=qp(qp(<span class="number">2</span>,n<span class="number">-1</span>),m<span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>I’m recently studying using <strong>ocaml</strong>, which is a functional language.<br>So let’s rewrite the solution with <strong>ocaml</strong>.<br><figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> <span class="type">Scanf</span></span><br><span class="line"><span class="keyword">open</span> <span class="type">Printf</span></span><br><span class="line"><span class="keyword">open</span> <span class="type">Int64</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> md = <span class="number">1000000007L</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> f n m k =</span><br><span class="line">  <span class="keyword">if</span> k = -<span class="number">1L</span> &amp;&amp; <span class="type">Int64</span>.rem (<span class="type">Int64</span>.add m n) <span class="number">2L</span> = <span class="number">1L</span> <span class="keyword">then</span> <span class="number">0L</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">let</span> <span class="keyword">rec</span> g x y =</span><br><span class="line">      <span class="keyword">if</span> y = <span class="number">0L</span> <span class="keyword">then</span> <span class="number">1L</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> y = <span class="number">1L</span> <span class="keyword">then</span> x</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">let</span> tmp = g x (<span class="type">Int64</span>.div y <span class="number">2L</span>) <span class="keyword">in</span></span><br><span class="line">          <span class="keyword">if</span> <span class="type">Int64</span>.rem y <span class="number">2L</span> = <span class="number">0L</span> <span class="keyword">then</span> <span class="type">Int64</span>.rem (<span class="type">Int64</span>.mul tmp tmp) md </span><br><span class="line">          <span class="keyword">else</span> <span class="type">Int64</span>.rem (<span class="type">Int64</span>.mul (<span class="type">Int64</span>.rem (<span class="type">Int64</span>.mul tmp tmp) md) x) md <span class="keyword">in</span></span><br><span class="line">    g (g <span class="number">2L</span> (<span class="type">Int64</span>.sub n <span class="number">1L</span>)) (<span class="type">Int64</span>.sub m <span class="number">1L</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="literal">()</span> =</span><br><span class="line">  <span class="keyword">let</span> ans = bscanf <span class="type">Scanning</span>.stdin <span class="string">"%Ld %Ld %Ld"</span> f <span class="keyword">in</span></span><br><span class="line">    printf <span class="string">"%Ld\n"</span> ans</span><br></pre></td></tr></table></figure><br>Though it may be very difficult to use it in a contest temporarily, I have a great interest in this language.<br>The problem: <a href="http://codeforces.com/problemset/problem/894/B" target="_blank" rel="noopener">Codeforces 894B Ralph And His Magic Field</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/11/25/cf-894B/" data-id="cjmkpj1rm0004j8tsjizv5z0d" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ad-hoc/">ad-hoc</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/codeforces/">codeforces</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-notes-on-muduo-timer" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/07/notes-on-muduo-timer/" class="article-date">
  <time datetime="2017-11-07T03:41:55.000Z" itemprop="datePublished">2017-11-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/07/notes-on-muduo-timer/">Notes on Muduo Timer</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Recently I am studying <a href="https://github.com/chenshuo/muduo" target="_blank" rel="noopener">Muduo</a>, a net library written by ChenShuo.<br>And I think the timer system of it is worth learning, so I did some notes on it in this article.</p>
<h2 id="What-is-a-timer"><a href="#What-is-a-timer" class="headerlink" title="What is a timer?"></a>What is a timer?</h2><p><em>A timer allows us to do something at a specific time later.</em>  This is not quoted from someone’s words. This is just my own understanding. Say, now we want to run a function, instead of running it immediately, we want to run it after 2 seconds. And a timer enables us to do something like that.</p>
<h2 id="How-do-we-use-timer-in-Muduo"><a href="#How-do-we-use-timer-in-Muduo" class="headerlink" title="How do we use timer in Muduo?"></a>How do we use timer in Muduo?</h2><p>At the very beginning, we have to know a very important idea about Muduo: <strong>One loop per thread</strong>, which is also emphasized by the author. The core class of Muduo is <code>EventLoop</code>. Each <code>EventLoop</code> is bind to a thread and will loop forever to run the thread until we call the <code>quit()</code> method of it. Every thing runs in one of the EventLoops in Muduo. So, if we want to run a function in 2 seconds, we run the function in one of the EventLoops. Apparently, we run our functions in some thread.<br>Muduo provides us with three methods to add a timer and one to cancel a timer:<br><figure class="highlight cpp"><figcaption><span>interfaces</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="comment">/// Runs callback at 'time'.</span></span><br><span class="line"><span class="comment">/// Safe to call from other threads.</span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="function">TimerId <span class="title">runAt</span><span class="params">(<span class="keyword">const</span> Timestamp&amp; time, <span class="keyword">const</span> TimerCallback&amp; cb)</span></span>;</span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="comment">/// Runs callback after @c delay seconds.</span></span><br><span class="line"><span class="comment">/// Safe to call from other threads.</span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="function">TimerId <span class="title">runAfter</span><span class="params">(<span class="keyword">double</span> delay, <span class="keyword">const</span> TimerCallback&amp; cb)</span></span>;</span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="comment">/// Runs callback every @c interval seconds.</span></span><br><span class="line"><span class="comment">/// Safe to call from other threads.</span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="function">TimerId <span class="title">runEvery</span><span class="params">(<span class="keyword">double</span> interval, <span class="keyword">const</span> TimerCallback&amp; cb)</span></span>;</span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="comment">/// Cancels the timer.</span></span><br><span class="line"><span class="comment">/// Safe to call from other threads.</span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cancel</span><span class="params">(TimerId timerId)</span></span>;</span><br></pre></td></tr></table></figure><br>It would be unnessary to explain what does every above method do. However, I should still explain something else:</p>
<ul>
<li>A <code>Timer</code> is actually an expiration time with a callback function. The callback function would be called when it expired. </li>
<li>A <code>TimerId</code> is an identification of a timer so that we can cancel a timer.</li>
<li><code>Timestamp</code> is actually micro seconds since epoch.</li>
<li><code>TimerCallback</code> is a function object, which we want to run in the future.</li>
</ul>
<h2 id="How-does-these-timer-function-work"><a href="#How-does-these-timer-function-work" class="headerlink" title="How does these timer function work?"></a>How does these timer function work?</h2><p>Now we come to the critical and interesting part, let’s try to figure out how our functions are called when their time expired. In this section, we will take a look at the whole process, from the moment a timer was added to the moment its callback was called. Firstly, I need to introduce the core class of the timer system: <code>TimerQueue</code>. It is invisible to the clients.<br>The private members of it is as follow:<br><figure class="highlight cpp"><figcaption><span>members</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// <span class="doctag">FIXME:</span> use unique_ptr&lt;Timer&gt; instead of raw pointers.</span></span><br><span class="line"><span class="comment">// This requires heterogeneous comparison lookup (N3465) from C++14</span></span><br><span class="line"><span class="comment">// so that we can find an T* in a set&lt;unique_ptr&lt;T&gt;&gt;.</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">std</span>::pair&lt;Timestamp, Timer*&gt; Entry;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">std</span>::<span class="built_in">set</span>&lt;Entry&gt; TimerList;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">std</span>::pair&lt;Timer*, <span class="keyword">int64_t</span>&gt; ActiveTimer;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">std</span>::<span class="built_in">set</span>&lt;ActiveTimer&gt; ActiveTimerSet;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addTimerInLoop</span><span class="params">(Timer* timer)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cancelInLoop</span><span class="params">(TimerId timerId)</span></span>;</span><br><span class="line"><span class="comment">// called when timerfd alarms</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">handleRead</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">// move out all expired timers</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;Entry&gt; getExpired(Timestamp now);</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reset</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;Entry&gt;&amp; expired, Timestamp now)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">insert</span><span class="params">(Timer* timer)</span></span>;</span><br><span class="line"></span><br><span class="line">EventLoop* loop_;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> timerfd_;</span><br><span class="line">Channel timerfdChannel_;</span><br><span class="line"><span class="comment">// Timer list sorted by expiration</span></span><br><span class="line">TimerList timers_;</span><br><span class="line"></span><br><span class="line"><span class="comment">// for cancel()</span></span><br><span class="line">ActiveTimerSet activeTimers_;</span><br><span class="line"><span class="keyword">bool</span> callingExpiredTimers_; <span class="comment">/* atomic */</span></span><br><span class="line">ActiveTimerSet cancelingTimers_;</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>I am not going to elaborate every member here. I put the code here because I may refer to some of these members later. Now we see the whole process. Actually, the problem is all about how to make our thread waked up when time is up.</p>
<h4 id="How-to-do-that"><a href="#How-to-do-that" class="headerlink" title="How to do that?"></a>How to do that?</h4><p>The way Muduo use to do such thing is quite different from what I once did. I once used two stupid methods, <code>sleep</code> and <code>busy loop and judge</code>. They are bad as far as accuracy is concerned. Besides, they are quite ‘low’ and ‘unprofessional’, right? Students may do that. But we need to be  professional. Muduo uses <code>timerfd</code> with <code>poll</code>. When I refer to <code>poll</code>, I mean <code>select</code>, <code>poll</code>, <code>epoll</code>. They are provided by linux system. If you are not clear about them, man them on a linux system or search the internet. I assumed you know the basic things about <code>poll</code> here.<br>However, <code>timerfd</code> is something new to me. A <code>timerfd</code> is a special file descriptor which will become readable when the time we set expires. It is done by the linux system. Wow, wonderful! This enables us to take an expiration as the same thing with an I/O event. And we can detect these events with <code>poll</code>.</p>
<h4 id="How-to-add-a-Timer"><a href="#How-to-add-a-Timer" class="headerlink" title="How to add a Timer?"></a>How to add a Timer?</h4><ol>
<li>At the very beginning, we create a timerfd by calling <code>timerfd_create</code> of linux. This is done only once. But we may set the timerfd many times later. We may have a lot of timers, and we want to be notified when the earliest one of them expired.</li>
<li>Insert the timer into the data structure we use to store them, which is <code>timers_</code> here. As you can see, there is another member <code>activeTimers_</code>. Unfortunately I don’t understand what is it for. But it doesn’t matter. Notice the definition of <code>TimerList</code> and <code>Entry</code>. <code>TimerList</code> is a set of <code>Entry</code>. An <code>std::set</code> is an ordered container implemented by RBTree. We store entries in it so that they can be sorted by their expiration time, which is represented by a <code>Timestamp</code>. Considering different timers may have the same timestamp, we make pair a timestamp with a pointer of the timer. This ensures us no collisions between timers.</li>
<li>Reset the <code>timerfd</code> if necessary. This should be done when the latest inserted timer would expire earliest. We do this by calling linux function <code>timerfd_settime</code>.  </li>
</ol>
<h4 id="How-to-call-the-callbacks-when-they-expired"><a href="#How-to-call-the-callbacks-when-they-expired" class="headerlink" title="How to call the callbacks when they expired?"></a>How to call the callbacks when they expired?</h4><p>As I mentioned above, a timerfd is treated as a normal fd. And we use <code>poll</code> function to detect that. By the way, let’s take a look at Muduo’s thread model. Muduo is of the <code>Reactor</code> Pattern.<br>Every single loop of <code>EventLoop</code> looks like this:<br><img src="https://raw.githubusercontent.com/Irving-cl/blog_assets/master/notes_on_muduo_timer/muduo_reactor.png" alt="img"></p>
<ol>
<li>At first, a poller will poll all the fds and update the channels. A channel can be seen as a bridge between low-level I/O and high-level callbacks; Notice that there is a <code>timerfdChannel_</code> in TimerQueue’s members. Once the time we set expired, the <code>timerfdChannel_</code> will be updated.</li>
<li>After that, <code>timerfdChannel_</code> found that the fd it took charge became readable, it call its handleRead function.</li>
<li>In its handleRead function, it will remove all the expired timers and run their callbacks. Of course, we should also read the timerfd and reset it.   </li>
</ol>
<p>Now I think we have a general idea about how muduo timer works. The core of the implementation is <code>timerfd</code>, <code>poll</code> and <code>Reactor</code> pattern. Thanks for reading!</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/11/07/notes-on-muduo-timer/" data-id="cjmkpj1s9000qj8tsrixwssxh" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cpp/">cpp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/net/">net</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/competitive-programming/">competitive programming</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ad-hoc/">ad-hoc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/brute-force/">brute force</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cmake/">cmake</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/codeforces/">codeforces</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/combinatorics/">combinatorics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/connectivity/">connectivity</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cpp/">cpp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/data-structure/">data structure</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dfs/">dfs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dynamic-programming/">dynamic programming</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/geometry/">geometry</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/graph-theory/">graph theory</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maths/">maths</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/max-flow/">max-flow</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/minimum-cut/">minimum-cut</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/net/">net</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/segment-tree/">segment tree</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/square-decomposition/">square decomposition</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/state-compression/">state compression</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/ad-hoc/" style="font-size: 10px;">ad-hoc</a> <a href="/tags/algorithm/" style="font-size: 20px;">algorithm</a> <a href="/tags/brute-force/" style="font-size: 10px;">brute force</a> <a href="/tags/cmake/" style="font-size: 10px;">cmake</a> <a href="/tags/codeforces/" style="font-size: 17.5px;">codeforces</a> <a href="/tags/combinatorics/" style="font-size: 10px;">combinatorics</a> <a href="/tags/connectivity/" style="font-size: 10px;">connectivity</a> <a href="/tags/cpp/" style="font-size: 10px;">cpp</a> <a href="/tags/data-structure/" style="font-size: 10px;">data structure</a> <a href="/tags/dfs/" style="font-size: 10px;">dfs</a> <a href="/tags/dynamic-programming/" style="font-size: 15px;">dynamic programming</a> <a href="/tags/geometry/" style="font-size: 12.5px;">geometry</a> <a href="/tags/graph-theory/" style="font-size: 10px;">graph theory</a> <a href="/tags/maths/" style="font-size: 10px;">maths</a> <a href="/tags/max-flow/" style="font-size: 12.5px;">max-flow</a> <a href="/tags/minimum-cut/" style="font-size: 10px;">minimum-cut</a> <a href="/tags/net/" style="font-size: 10px;">net</a> <a href="/tags/segment-tree/" style="font-size: 10px;">segment tree</a> <a href="/tags/square-decomposition/" style="font-size: 10px;">square decomposition</a> <a href="/tags/state-compression/" style="font-size: 10px;">state compression</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/09/27/connectivity-and-tarjan-algorithm/">Connectivity &amp; Tarjan Algorithm</a>
          </li>
        
          <li>
            <a href="/2018/07/15/minimum-cut-problems/">Minimum Cut Problems</a>
          </li>
        
          <li>
            <a href="/2018/07/08/cf-992E/">Codeforces 992E - Nastya and King-Shamans</a>
          </li>
        
          <li>
            <a href="/2018/07/07/cf-995C/">Codeforces 995C Leaving the Bar</a>
          </li>
        
          <li>
            <a href="/2018/07/07/subsets-property-merge/">Subsets Property Merge</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 Cao Li<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
<script src="/node_modules/live2d-widget/node_modules/live2d-widget/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginRootPath":"node_modules/live2d-widget/","pluginJsPath":"node_modules/live2d-widget/lib/","pluginModelPath":"node_modules/live2d-widget-model-hijiki/assets","model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/node_modules/live2d-widget/node_modules/live2d-widget-model-hijiki/hijiki.model.json"},"display":{"superSample":2,"width":150,"height":300,"position":"right","hOffset":0,"vOffset":-20},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2}});</script></body>
</html>